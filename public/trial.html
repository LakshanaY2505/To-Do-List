<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Todo List with Progress</title>
  <style>
    body {
      background: #0a0000;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      font-family: Arial, sans-serif;
    }

    .todo-widget {
      width: 400px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      padding: 20px;
    }

    .banner {
      text-align: center;
      margin-bottom: 20px;
    }

    .banner h1 {
      margin: 0;
      font-size: 22px;
    }

    #todo-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .todo-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin: 6px 0;
      padding: 6px 8px;
      border-bottom: 1px solid #ddd;
    }

    .todo-item.completed span {
      text-decoration: line-through;
      color: gray;
    }

    #todo-input {
      width: calc(100% - 60px);
      padding: 6px;
      font-size: 16px;
    }

    #add-btn {
      width: 50px;
      padding: 6px;
      font-size: 16px;
    }

    #empty-state {
      text-align: center;
      color: gray;
      margin: 10px 0;
    }

    #clear-completed-btn.show {
      display: block;
    }

    #clear-completed-btn {
      margin-top: 10px;
      display: none;
      width: 100%;
      padding: 6px;
      cursor: pointer;
    }

    /* Progress bar */
    .progress-container {
      position: relative;
      width: 90%;
      height: 14px;
      background: #ec8686;
      border-radius: 999px;
      overflow: visible;
      margin: 20px auto;
    }

    .progress-bar {
      width: 0%;
      height: 100%;
      background: #4caf50;
      transition: width 0.3s ease;
    }

    .progress-image {
      position: absolute;
      top: -30px;
      left: 0;
      height: 70px;
      transition: left 0.3s ease;
      pointer-events: none;

       /* This allows the image to be centered on its left position */
      transform: translateX(0); /* we'll update in JS */
    }
  </style>
</head>
<body>
  <div class="todo-widget">
    <div class="banner">
      <h1>My Tasks</h1>
    </div>

    <div style="display:flex; gap:5px; margin-bottom:10px;">
      <input type="text" id="todo-input" placeholder="Add new task">
      <button id="add-btn">Add</button>
    </div>

    <ul id="todo-list"></ul>
    <div id="empty-state">No tasks yet</div>

    <div class="progress-container" id="progress-container">
      <div class="progress-bar" id="progress-bar"></div>
      <img src="./turtle.png" id="progress-image" class="progress-image">
    </div>

    <button id="clear-completed-btn">Clear Completed</button>
  </div>

  <script>
    class TodoApp {
      constructor() {
        this.todos = [];
        this.todoIdCounter = 1;
    
        this.todoInput = document.getElementById('todo-input');
        this.addBtn = document.getElementById('add-btn');
        this.todoList = document.getElementById('todo-list');
        this.emptyState = document.getElementById('empty-state');
        this.clearCompletedBtn = document.getElementById('clear-completed-btn');
    
        this.progressBar = document.getElementById('progress-bar');
        this.progressImage = document.getElementById('progress-image');
        this.progressContainer = document.getElementById('progress-container');
    
        // Enable Add button when typing
        this.todoInput.addEventListener('input', () => {
          this.addBtn.disabled = !this.todoInput.value.trim();
        });
    
        this.addBtn.addEventListener('click', () => this.addTodo());
        this.todoInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') this.addTodo();
        });
        this.clearCompletedBtn.addEventListener('click', () => this.clearCompleted());
    
        this.renderTodos();
        this.updateStats();
    
        // Ensure image is at start once loaded
        if (this.progressImage.complete) {
          this.setProgressImage(0);
        } else {
          this.progressImage.onload = () => this.setProgressImage(0);
        }
      }
    
      addTodo() {
        const text = this.todoInput.value.trim();
        if (!text) return;
    
        this.todos.push({ id: this.todoIdCounter++, text: text, completed: false });
        this.todoInput.value = '';
        this.addBtn.disabled = true;
    
        this.renderTodos();
        this.updateStats();
      }
    
      toggleComplete(id) {
        const todo = this.todos.find(t => t.id === id);
        if (todo) todo.completed = !todo.completed;
        this.renderTodos();
        this.updateStats();
      }
    
      deleteTodo(id) {
        this.todos = this.todos.filter(t => t.id !== id);
        this.renderTodos();
        this.updateStats();
      }
    
      clearCompleted() {
        this.todos = this.todos.filter(t => !t.completed);
        this.renderTodos();
        this.updateStats();
      }
    
      renderTodos() {
        this.todoList.innerHTML = '';
        if (this.todos.length === 0) {
          this.emptyState.style.display = 'block';
        } else {
          this.emptyState.style.display = 'none';
        }
    
        this.todos.forEach(todo => {
          const li = document.createElement('li');
          li.className = `todo-item ${todo.completed ? 'completed' : ''}`;
    
          const span = document.createElement('span');
          span.textContent = todo.text;
          span.style.cursor = 'pointer';
          span.addEventListener('click', () => this.toggleComplete(todo.id));
    
          const deleteBtn = document.createElement('button');
          deleteBtn.textContent = 'Ã—';
          deleteBtn.className = 'delete-btn';
          deleteBtn.addEventListener('click', () => this.deleteTodo(todo.id));
    
          li.appendChild(span);
          li.appendChild(deleteBtn);
          this.todoList.appendChild(li);
        });
      }
    
      updateStats() {
        const total = this.todos.length;
        const completed = this.todos.filter(t => t.completed).length;
    
        // Progress percentage
        const percentage = total === 0 ? 0 : (completed / total) * 100;
        this.progressBar.style.width = percentage + '%';
    
        // Move image along the bar
        this.setProgressImage(percentage);
    
        // Show/hide Clear Completed button
        if (completed > 0) {
          this.clearCompletedBtn.classList.add('show');
          this.clearCompletedBtn.style.display = 'block';
          this.clearCompletedBtn.textContent = `Clear Completed (${completed})`;
        } else {
          this.clearCompletedBtn.classList.remove('show');
          this.clearCompletedBtn.style.display = 'none';
        }
      }
    
      setProgressImage(percentage) {
        if (this.progressImage && this.progressContainer) {
          const containerWidth = this.progressContainer.offsetWidth;
          const imgWidth = this.progressImage.offsetWidth;
    
          const newLeft = (percentage / 100) * containerWidth;
          this.progressImage.style.left = newLeft + "px";
          this.progressImage.style.transform = `translateX(-${imgWidth / 2}px)`;
        }
      }
    }
    
    document.addEventListener('DOMContentLoaded', () => {
      new TodoApp();
    });
    </script>
    
</body>
</html>
